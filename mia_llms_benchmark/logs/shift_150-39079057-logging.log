2025-05-30 03:13:38,007 - root - INFO - Args: Namespace(config='exp_configs/config_template_traps_ip_fast.yaml', attacks=None, run_all=True, seed=42, output='/ibex/user/wangc0g/projs/Evaluate-Unlearning/mia_llms_benchmark/exp_output/output_shift_150_39079057.pkl', log_folder='logs', slurm_name='shift_150', slurm_id='39079057', local_rank=0, STEPs=['450', '550', '150', '250'])
2025-05-30 03:13:38,007 - root - INFO - Log_file_path: logs/shift_150-39079057-logging.log
2025-05-30 03:13:38,014 - root - INFO - Config: {'global': {'target_model': '/ibex/project/c2283/Llama-2-7b-ft-muse-news/llama2-7b-muse-news-original_new/checkpoint-STEP', 'datasets': [{'muse_name': 'muse-bench/MUSE-News'}], 'batch_size': 8, 'device': 'cuda', 'fpr_thresholds': [0.1, 0.01], 'n_bootstrap_samples': 1000, 'ref_model': 'croissantllm/base_190k', 'fitRef_model': './finetune/llama2-7b-muse-bench-news-original-final'}, 'bag_of_words': {'module': 'bag_of_words', 'test_size': 0.2, 'min_df': 0.05, 'n_estimators': 100, 'max_depth': 2, 'min_samples_leaf': 5, 'seed': 42, 'device': 'cuda', 'batch_size': 64}, 'ratio': {'module': 'ratio', 'ref_model': True, 'batch_size': 64, 'device': 'cuda'}, 'ratio_online': {'module': 'ratio_online', 'ref_model': True, 'batch_size': 32, 'fitRef_model': True, 'fit_datasets': [{'mimir_name': 'arxiv', 'split': 'ngram_13_0.8'}], 'device': 'cuda', 'metric': 'avg_token_loss'}, 'rmia_online': {'module': 'rmia_online', 'ref_model': True, 'batch_size': 64, 'fitRef_model': True, 'fit_datasets': [{'mimir_name': 'arxiv', 'split': 'ngram_13_0.8'}], 'device': 'cuda', 'metric': 'avg_token_loss'}, 'ip_fit': {'module': 'ip', 'ref_model': True, 'fitRef_model': True, 'fit_datasets': [{'mimir_name': 'arxiv', 'split': 'ngram_13_0.8'}], 'batch_size': 64, 'device': 'cuda', 'metric': 'avg_token_loss'}, 'loss': {'module': 'loss', 'device': 'cuda', 'batch_size': 64}, 'zlib': {'module': 'zlib', 'device': 'cuda', 'batch_size': 64}, 'surp_40_2': {'module': 'surp', 'k': 40, 'max_entropy': 2.0, 'batch_size': 8, 'device': 'cuda'}, 'minkprob': {'module': 'minkprob', 'k': 20, 'batch_size': 8, 'device': 'cuda'}, 'minkplusplus': {'module': 'minkplusplus', 'k': 20, 'batch_size': 8, 'device': 'cuda'}}
2025-05-30 03:14:03,982 - root - INFO - Loading dataset {'muse_name': 'muse-bench/MUSE-News'}
2025-05-30 03:52:38,995 - root - INFO - Saved processed data to logs/shift_150-39079057-muse-bench/MUSE-News
2025-05-30 04:00:26,705 - root - INFO - Saved ref_nlloss signals to logs/shift_150-39079057-muse-bench/MUSE-News-ref_nlloss.txt
2025-05-30 04:38:52,068 - root - INFO - Saved fitRef_nlloss signals to logs/shift_150-39079057-muse-bench/MUSE-News-fitRef_nlloss.txt
2025-05-30 04:38:52,323 - root - INFO - y_true: 0.6632 1s, 0.3368 0s
2025-05-30 05:17:28,166 - root - INFO - Saved processed data to logs/shift_150-39079057-muse-bench/MUSE-News
2025-05-30 05:17:28,167 - root - INFO - Running attack zlib on dataset muse-bench_MUSE-News
2025-05-30 05:18:09,439 - root - INFO - AUC zlib-450 on muse-bench_MUSE-News:  0.5448 ± 0.0083
2025-05-30 05:18:09,439 - root - INFO - Running attack surp_40_2 on dataset muse-bench_MUSE-News
2025-05-30 05:56:43,533 - root - INFO - AUC surp_40_2-450 on muse-bench_MUSE-News:  0.5438 ± 0.0079
2025-05-30 05:56:43,533 - root - INFO - Running attack rmia_online on dataset muse-bench_MUSE-News
2025-05-30 05:58:20,164 - root - INFO - AUC rmia_online-450 on muse-bench_MUSE-News:  0.5417 ± 0.0080
2025-05-30 05:58:20,164 - root - INFO - Running attack ratio_online on dataset muse-bench_MUSE-News
2025-05-30 05:58:22,516 - root - INFO - AUC ratio_online-450 on muse-bench_MUSE-News:  0.5636 ± 0.0085
2025-05-30 05:58:22,516 - root - INFO - Running attack ratio on dataset muse-bench_MUSE-News
2025-05-30 05:59:05,701 - root - INFO - AUC ratio-450 on muse-bench_MUSE-News:  0.5506 ± 0.0080
2025-05-30 05:59:05,701 - root - INFO - Running attack minkprob on dataset muse-bench_MUSE-News
2025-05-30 06:37:31,206 - root - WARNING - NaN values in y_pred count = 19
2025-05-30 06:37:32,499 - root - INFO - AUC minkprob-450 on muse-bench_MUSE-News:  0.5343 ± 0.0079
2025-05-30 06:37:32,499 - root - INFO - Running attack minkplusplus on dataset muse-bench_MUSE-News
2025-05-30 07:16:02,299 - root - WARNING - NaN values in y_pred count = 19
2025-05-30 07:16:03,591 - root - INFO - AUC minkplusplus-450 on muse-bench_MUSE-News:  0.5382 ± 0.0081
2025-05-30 07:16:03,591 - root - INFO - Running attack loss on dataset muse-bench_MUSE-News
2025-05-30 07:16:36,976 - root - INFO - AUC loss-450 on muse-bench_MUSE-News:  0.5420 ± 0.0081
2025-05-30 07:16:36,977 - root - INFO - Running attack ip_fit on dataset muse-bench_MUSE-News
2025-05-30 07:16:40,706 - root - INFO - AUC ip_fit-450 on muse-bench_MUSE-News:  0.5357 ± 0.0078
2025-05-30 07:16:40,706 - root - INFO - Running attack bag_of_words on dataset muse-bench_MUSE-News
2025-05-30 07:17:17,525 - root - INFO - AUC bag_of_words-450 on muse-bench_MUSE-News:  0.5418 ± 0.0080
2025-05-30 07:55:53,439 - root - INFO - Saved processed data to logs/shift_150-39079057-muse-bench/MUSE-News
2025-05-30 07:55:53,439 - root - INFO - Running attack zlib on dataset muse-bench_MUSE-News
2025-05-30 07:56:22,803 - root - INFO - AUC zlib-550 on muse-bench_MUSE-News:  0.5328 ± 0.0081
2025-05-30 07:56:22,803 - root - INFO - Running attack surp_40_2 on dataset muse-bench_MUSE-News
2025-05-30 08:34:57,149 - root - INFO - AUC surp_40_2-550 on muse-bench_MUSE-News:  0.5287 ± 0.0081
2025-05-30 08:34:57,149 - root - INFO - Running attack rmia_online on dataset muse-bench_MUSE-News
2025-05-30 08:35:07,333 - root - INFO - AUC rmia_online-550 on muse-bench_MUSE-News:  0.5209 ± 0.0074
2025-05-30 08:35:07,333 - root - INFO - Running attack ratio_online on dataset muse-bench_MUSE-News
2025-05-30 08:35:10,610 - root - INFO - AUC ratio_online-550 on muse-bench_MUSE-News:  0.5497 ± 0.0080
2025-05-30 08:35:10,610 - root - INFO - Running attack ratio on dataset muse-bench_MUSE-News
2025-05-30 08:35:49,781 - root - INFO - AUC ratio-550 on muse-bench_MUSE-News:  0.5364 ± 0.0081
2025-05-30 08:35:49,781 - root - INFO - Running attack minkprob on dataset muse-bench_MUSE-News
2025-05-30 09:14:16,950 - root - WARNING - NaN values in y_pred count = 19
2025-05-30 09:14:18,237 - root - INFO - AUC minkprob-550 on muse-bench_MUSE-News:  0.5240 ± 0.0080
2025-05-30 09:14:18,237 - root - INFO - Running attack minkplusplus on dataset muse-bench_MUSE-News
2025-05-30 09:52:49,756 - root - WARNING - NaN values in y_pred count = 19
2025-05-30 09:52:51,050 - root - INFO - AUC minkplusplus-550 on muse-bench_MUSE-News:  0.5305 ± 0.0083
2025-05-30 09:52:51,050 - root - INFO - Running attack loss on dataset muse-bench_MUSE-News
2025-05-30 09:53:19,222 - root - INFO - AUC loss-550 on muse-bench_MUSE-News:  0.5312 ± 0.0078
2025-05-30 09:53:19,222 - root - INFO - Running attack ip_fit on dataset muse-bench_MUSE-News
2025-05-30 09:53:23,319 - root - INFO - AUC ip_fit-550 on muse-bench_MUSE-News:  0.5147 ± 0.0080
2025-05-30 09:53:23,320 - root - INFO - Running attack bag_of_words on dataset muse-bench_MUSE-News
2025-05-30 09:53:56,309 - root - INFO - AUC bag_of_words-550 on muse-bench_MUSE-News:  0.5334 ± 0.0081
2025-05-30 10:32:32,979 - root - INFO - Saved processed data to logs/shift_150-39079057-muse-bench/MUSE-News
2025-05-30 10:32:32,979 - root - INFO - Running attack zlib on dataset muse-bench_MUSE-News
2025-05-30 10:33:01,805 - root - INFO - AUC zlib-150 on muse-bench_MUSE-News:  0.5536 ± 0.0079
2025-05-30 10:33:01,805 - root - INFO - Running attack surp_40_2 on dataset muse-bench_MUSE-News
2025-05-30 11:11:37,566 - root - INFO - AUC surp_40_2-150 on muse-bench_MUSE-News:  0.5510 ± 0.0083
2025-05-30 11:11:37,566 - root - INFO - Running attack rmia_online on dataset muse-bench_MUSE-News
2025-05-30 11:11:47,700 - root - INFO - AUC rmia_online-150 on muse-bench_MUSE-News:  0.5869 ± 0.0078
2025-05-30 11:11:47,700 - root - INFO - Running attack ratio_online on dataset muse-bench_MUSE-News
2025-05-30 11:11:51,771 - root - INFO - AUC ratio_online-150 on muse-bench_MUSE-News:  0.5944 ± 0.0081
2025-05-30 11:11:51,771 - root - INFO - Running attack ratio on dataset muse-bench_MUSE-News
2025-05-30 11:12:29,750 - root - INFO - AUC ratio-150 on muse-bench_MUSE-News:  0.5852 ± 0.0078
2025-05-30 11:12:29,751 - root - INFO - Running attack minkprob on dataset muse-bench_MUSE-News
2025-05-30 11:50:58,234 - root - WARNING - NaN values in y_pred count = 19
2025-05-30 11:50:59,522 - root - INFO - AUC minkprob-150 on muse-bench_MUSE-News:  0.5499 ± 0.0080
2025-05-30 11:50:59,522 - root - INFO - Running attack minkplusplus on dataset muse-bench_MUSE-News
2025-05-30 12:29:31,002 - root - WARNING - NaN values in y_pred count = 19
2025-05-30 12:29:32,291 - root - INFO - AUC minkplusplus-150 on muse-bench_MUSE-News:  0.5404 ± 0.0081
2025-05-30 12:29:32,291 - root - INFO - Running attack loss on dataset muse-bench_MUSE-News
2025-05-30 12:30:00,625 - root - INFO - AUC loss-150 on muse-bench_MUSE-News:  0.5507 ± 0.0081
2025-05-30 12:30:00,626 - root - INFO - Running attack ip_fit on dataset muse-bench_MUSE-News
2025-05-30 12:30:05,541 - root - INFO - AUC ip_fit-150 on muse-bench_MUSE-News:  0.5759 ± 0.0080
2025-05-30 12:30:05,541 - root - INFO - Running attack bag_of_words on dataset muse-bench_MUSE-News
2025-05-30 12:30:39,691 - root - INFO - AUC bag_of_words-150 on muse-bench_MUSE-News:  0.5361 ± 0.0077
2025-05-30 13:09:17,384 - root - INFO - Saved processed data to logs/shift_150-39079057-muse-bench/MUSE-News
2025-05-30 13:09:17,384 - root - INFO - Running attack zlib on dataset muse-bench_MUSE-News
2025-05-30 13:09:45,429 - root - INFO - AUC zlib-250 on muse-bench_MUSE-News:  0.5638 ± 0.0077
2025-05-30 13:09:45,429 - root - INFO - Running attack surp_40_2 on dataset muse-bench_MUSE-News
2025-05-30 13:48:22,511 - root - INFO - AUC surp_40_2-250 on muse-bench_MUSE-News:  0.5635 ± 0.0080
2025-05-30 13:48:22,511 - root - INFO - Running attack rmia_online on dataset muse-bench_MUSE-News
2025-05-30 13:48:33,808 - root - INFO - AUC rmia_online-250 on muse-bench_MUSE-News:  0.5828 ± 0.0078
2025-05-30 13:48:33,808 - root - INFO - Running attack ratio_online on dataset muse-bench_MUSE-News
2025-05-30 13:48:38,731 - root - INFO - AUC ratio_online-250 on muse-bench_MUSE-News:  0.5889 ± 0.0078
2025-05-30 13:48:38,731 - root - INFO - Running attack ratio on dataset muse-bench_MUSE-News
2025-05-30 13:49:15,756 - root - INFO - AUC ratio-250 on muse-bench_MUSE-News:  0.5810 ± 0.0080
2025-05-30 13:49:15,756 - root - INFO - Running attack minkprob on dataset muse-bench_MUSE-News
2025-05-30 14:27:45,242 - root - WARNING - NaN values in y_pred count = 19
2025-05-30 14:27:46,526 - root - INFO - AUC minkprob-250 on muse-bench_MUSE-News:  0.5529 ± 0.0080
2025-05-30 14:27:46,526 - root - INFO - Running attack minkplusplus on dataset muse-bench_MUSE-News
2025-05-30 15:06:19,311 - root - WARNING - NaN values in y_pred count = 19
2025-05-30 15:06:20,600 - root - INFO - AUC minkplusplus-250 on muse-bench_MUSE-News:  0.5505 ± 0.0079
2025-05-30 15:06:20,600 - root - INFO - Running attack loss on dataset muse-bench_MUSE-News
2025-05-30 15:06:50,725 - root - INFO - AUC loss-250 on muse-bench_MUSE-News:  0.5611 ± 0.0079
2025-05-30 15:06:50,725 - root - INFO - Running attack ip_fit on dataset muse-bench_MUSE-News
2025-05-30 15:06:56,398 - root - INFO - AUC ip_fit-250 on muse-bench_MUSE-News:  0.5736 ± 0.0078
2025-05-30 15:06:56,399 - root - INFO - Running attack bag_of_words on dataset muse-bench_MUSE-News
2025-05-30 15:07:30,453 - root - INFO - AUC bag_of_words-250 on muse-bench_MUSE-News:  0.5381 ± 0.0083
2025-05-30 15:07:30,455 - root - INFO - Dataset: muse-bench_MUSE-News
2025-05-30 15:07:30,455 - root - INFO - +------------------+-----------------+-----------------+-----------------+
2025-05-30 15:07:30,455 - root - INFO - | MIA              | AUC             | TPR@FPR=0.1     | TPR@FPR=0.01    |
2025-05-30 15:07:30,455 - root - INFO - +==================+=================+=================+=================+
2025-05-30 15:07:30,455 - root - INFO - | zlib-450         | 0.5448 ± 0.0083 | 0.1736 ± 0.0080 | 0.0470 ± 0.0077 |
2025-05-30 15:07:30,455 - root - INFO - | surp_40_2-450    | 0.5438 ± 0.0079 | 0.1670 ± 0.0093 | 0.0388 ± 0.0092 |
2025-05-30 15:07:30,455 - root - INFO - | rmia_online-450  | 0.5417 ± 0.0080 | 0.1885 ± 0.0075 | 0.0000 ± 0.0000 |
2025-05-30 15:07:30,455 - root - INFO - | ratio_online-450 | 0.5636 ± 0.0085 | 0.1721 ± 0.0102 | 0.0285 ± 0.0058 |
2025-05-30 15:07:30,455 - root - INFO - | ratio-450        | 0.5506 ± 0.0080 | 0.1783 ± 0.0093 | 0.0441 ± 0.0085 |
2025-05-30 15:07:30,455 - root - INFO - | minkprob-450     | 0.5343 ± 0.0079 | 0.1671 ± 0.0082 | 0.0424 ± 0.0090 |
2025-05-30 15:07:30,455 - root - INFO - | minkplusplus-450 | 0.5382 ± 0.0081 | 0.1804 ± 0.0096 | 0.0625 ± 0.0086 |
2025-05-30 15:07:30,455 - root - INFO - | loss-450         | 0.5420 ± 0.0081 | 0.1707 ± 0.0088 | 0.0516 ± 0.0076 |
2025-05-30 15:07:30,455 - root - INFO - | ip_fit-450       | 0.5357 ± 0.0078 | 0.2111 ± 0.0082 | 0.0000 ± 0.0000 |
2025-05-30 15:07:30,455 - root - INFO - | bag_of_words-450 | 0.5418 ± 0.0080 | 0.1283 ± 0.0100 | 0.0177 ± 0.0044 |
2025-05-30 15:07:30,455 - root - INFO - | zlib-550         | 0.5328 ± 0.0081 | 0.1597 ± 0.0091 | 0.0364 ± 0.0058 |
2025-05-30 15:07:30,455 - root - INFO - | surp_40_2-550    | 0.5287 ± 0.0081 | 0.1427 ± 0.0111 | 0.0231 ± 0.0045 |
2025-05-30 15:07:30,456 - root - INFO - | rmia_online-550  | 0.5209 ± 0.0074 | 0.0000 ± 0.0000 | 0.0000 ± 0.0000 |
2025-05-30 15:07:30,456 - root - INFO - | ratio_online-550 | 0.5497 ± 0.0080 | 0.1554 ± 0.0102 | 0.0279 ± 0.0055 |
2025-05-30 15:07:30,456 - root - INFO - | ratio-550        | 0.5364 ± 0.0081 | 0.1632 ± 0.0089 | 0.0419 ± 0.0057 |
2025-05-30 15:07:30,456 - root - INFO - | minkprob-550     | 0.5240 ± 0.0080 | 0.1605 ± 0.0099 | 0.0286 ± 0.0067 |
2025-05-30 15:07:30,456 - root - INFO - | minkplusplus-550 | 0.5305 ± 0.0083 | 0.1690 ± 0.0085 | 0.0589 ± 0.0080 |
2025-05-30 15:07:30,456 - root - INFO - | loss-550         | 0.5312 ± 0.0078 | 0.1610 ± 0.0079 | 0.0377 ± 0.0083 |
2025-05-30 15:07:30,456 - root - INFO - | ip_fit-550       | 0.5147 ± 0.0080 | 0.0000 ± 0.0000 | 0.0000 ± 0.0000 |
2025-05-30 15:07:30,456 - root - INFO - | bag_of_words-550 | 0.5334 ± 0.0081 | 0.1282 ± 0.0093 | 0.0139 ± 0.0032 |
2025-05-30 15:07:30,456 - root - INFO - | zlib-150         | 0.5536 ± 0.0079 | 0.1676 ± 0.0092 | 0.0145 ± 0.0037 |
2025-05-30 15:07:30,456 - root - INFO - | surp_40_2-150    | 0.5510 ± 0.0083 | 0.1678 ± 0.0097 | 0.0161 ± 0.0036 |
2025-05-30 15:07:30,456 - root - INFO - | rmia_online-150  | 0.5869 ± 0.0078 | 0.1688 ± 0.0118 | 0.0385 ± 0.0098 |
2025-05-30 15:07:30,456 - root - INFO - | ratio_online-150 | 0.5944 ± 0.0081 | 0.2125 ± 0.0112 | 0.0206 ± 0.0050 |
2025-05-30 15:07:30,456 - root - INFO - | ratio-150        | 0.5852 ± 0.0078 | 0.2073 ± 0.0108 | 0.0228 ± 0.0057 |
2025-05-30 15:07:30,456 - root - INFO - | minkprob-150     | 0.5499 ± 0.0080 | 0.1658 ± 0.0101 | 0.0230 ± 0.0064 |
2025-05-30 15:07:30,456 - root - INFO - | minkplusplus-150 | 0.5404 ± 0.0081 | 0.1535 ± 0.0113 | 0.0226 ± 0.0066 |
2025-05-30 15:07:30,456 - root - INFO - | loss-150         | 0.5507 ± 0.0081 | 0.1677 ± 0.0084 | 0.0211 ± 0.0039 |
2025-05-30 15:07:30,456 - root - INFO - | ip_fit-150       | 0.5759 ± 0.0080 | 0.1845 ± 0.0110 | 0.0362 ± 0.0057 |
2025-05-30 15:07:30,456 - root - INFO - | bag_of_words-150 | 0.5361 ± 0.0077 | 0.1100 ± 0.0097 | 0.0100 ± 0.0033 |
2025-05-30 15:07:30,456 - root - INFO - | zlib-250         | 0.5638 ± 0.0077 | 0.1877 ± 0.0099 | 0.0411 ± 0.0087 |
2025-05-30 15:07:30,456 - root - INFO - | surp_40_2-250    | 0.5635 ± 0.0080 | 0.2004 ± 0.0106 | 0.0429 ± 0.0110 |
2025-05-30 15:07:30,456 - root - INFO - | rmia_online-250  | 0.5828 ± 0.0078 | 0.2180 ± 0.0081 | 0.0197 ± 0.0027 |
2025-05-30 15:07:30,456 - root - INFO - | ratio_online-250 | 0.5889 ± 0.0078 | 0.2243 ± 0.0131 | 0.0316 ± 0.0049 |
2025-05-30 15:07:30,456 - root - INFO - | ratio-250        | 0.5810 ± 0.0080 | 0.2143 ± 0.0113 | 0.0539 ± 0.0094 |
2025-05-30 15:07:30,456 - root - INFO - | minkprob-250     | 0.5529 ± 0.0080 | 0.1721 ± 0.0094 | 0.0443 ± 0.0075 |
2025-05-30 15:07:30,456 - root - INFO - | minkplusplus-250 | 0.5505 ± 0.0079 | 0.1814 ± 0.0100 | 0.0561 ± 0.0077 |
2025-05-30 15:07:30,456 - root - INFO - | loss-250         | 0.5611 ± 0.0079 | 0.1859 ± 0.0097 | 0.0500 ± 0.0078 |
2025-05-30 15:07:30,456 - root - INFO - | ip_fit-250       | 0.5736 ± 0.0078 | 0.2086 ± 0.0114 | 0.0494 ± 0.0075 |
2025-05-30 15:07:30,456 - root - INFO - | bag_of_words-250 | 0.5381 ± 0.0083 | 0.1286 ± 0.0098 | 0.0112 ± 0.0031 |
2025-05-30 15:07:30,456 - root - INFO - +------------------+-----------------+-----------------+-----------------+
2025-05-30 15:07:30,456 - root - INFO -  
